<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>ãƒ•ãƒ¤ã‚»ãƒ«äºˆç´„ç®¡ç†</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * { box-sizing: border-box; }
    body { font-family: sans-serif; background: #f5f7fb; padding: 20px; }
    .main-wrapper { display: flex; flex-wrap: wrap; gap: 20px; max-width: 1400px; margin: 0 auto; }
    .left-column { flex: 2; min-width: 600px; }
    .right-column { flex: 1; min-width: 350px; display: flex; flex-direction: column; gap: 20px; }
    .list-container { background: #fff; padding: 20px; border-radius: 14px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
    .table-wrapper { max-height: 500px; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; }
    table { width: 100%; border-collapse: collapse; white-space: nowrap; font-size: 13px; }
    th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; vertical-align: middle; }
    th { background-color: #f8f9fa; position: sticky; top: 0; z-index: 1; }
    tr.clickable { cursor: pointer; transition: background 0.1s; }
    tr.clickable:hover { background-color: #e3f2fd; }
    tr.selected { background-color: #bbdefb; border-left: 5px solid #2563eb; }
    .meet-link { display: inline-block; padding: 4px 8px; background: #dbeafe; color: #1e40af; border-radius: 4px; text-decoration: none; font-size: 12px; font-weight: bold; }
    .copy-link-btn { padding: 4px 8px; background: #f3f4f6; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; }
    .account-badge { font-size: 11px; background: #f3f4f6; padding: 2px 6px; border-radius: 4px; }
    .status-tag { padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; display:inline-block;}
    .status-red { color: #d93025; background: #fce8e6; border: 1px solid #f28b82; }
    .status-blue { color: #1a73e8; background: #e8f0fe; border: 1px solid #8ab4f8; }
    .status-orange { color: #e37400; background: #fcefc7; border: 1px solid #fdd663; }
    tr.row-cancelled td { text-decoration: line-through; color: #9ca3af; }
    tr.row-cancelled .meet-link, tr.row-cancelled .copy-link-btn { text-decoration: none; opacity: 0.6; }
    .method-select { border: 1px solid #ddd; padding: 4px; border-radius: 4px; font-size: 12px; background: #f9fafb; cursor: pointer; width: 110px; }
    .box { background: #fff; padding: 20px; border-radius: 14px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
    h1 { font-size: 18px; margin: 0 0 16px; }
    input, select, button, textarea { width: 100%; padding: 10px; margin-top: 6px; border-radius: 8px; border: 1px solid #ddd; }
    button { border: none; cursor: pointer; font-weight: bold; background: #2563eb; color: #fff; margin-top: 10px;}
    button:hover { opacity: 0.9; }
    .btn-sub { background:#fff; color:#333; border:1px solid #ddd; padding:8px 12px; font-size:13px; margin-right:5px; margin-bottom:5px; width:auto; }
    #btnTodayReset { background:#dcfce7; color:#166534; border-color:#86efac; }
    #btnDeleteDayBatch { background:#fee2e2; color:#991b1b; border-color:#fca5a5; }
    .danger { background: #ef4444; }
    .cancel-status-btn { background: #6b7280; }
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-bottom: 10px; }
    .cal-cell { aspect-ratio: 1; display: flex; justify-content: center; align-items: center; border-radius: 8px; cursor: pointer; background: #fff; border: 1px solid transparent; }
    .cal-cell:hover { filter: brightness(0.95); }
    .cal-today { border: 2px solid #2563eb; font-weight: bold; }
    .cal-selected { background-color: #2563eb; color: #fff; }
    .cal-has-event { background-color: #eff6ff; }
    .edit-status-row { display: flex; gap: 8px; align-items: flex-end; margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px; }
    .edit-status-row button { width: auto; background: #0891b2; font-size: 13px; padding: 10px 16px;}
    textarea { height: 180px; margin-top: 12px; font-size: 14px; line-height: 1.6; font-family: monospace; white-space: pre-wrap; }
    .action-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px; }
    @media (max-width: 900px) { .main-wrapper { flex-direction: column; } .left-column, .right-column { min-width: 100%; flex: auto; } }
  </style>
</head>
<body>
<div class="main-wrapper">
  <div class="left-column">
    <div class="list-container">
      <h2>ğŸ“… äºˆç´„ãƒªã‚¹ãƒˆ</h2>
      <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <button class="btn-sub" id="prevMonthBtn">ï¼œ</button>
          <span id="calendarTitle" style="font-weight:bold; font-size:1.1em;"></span>
          <button class="btn-sub" id="nextMonthBtn">ï¼</button>
      </div>
      <div class="calendar-grid" id="calendarGrid"></div>
      <div style="margin-bottom:15px;">
          <button class="btn-sub" id="btnTodayReset">ä»Šæ—¥ã«æˆ»ã‚‹</button>
          <button class="btn-sub" id="btnShowAll">å…¨ãƒªã‚¹ãƒˆè¡¨ç¤º</button>
      </div>
      <div style="margin-bottom:10px;">
          <button class="btn-sub" id="btnGenerateMeet" style="background:#e0e7ff; color:#3730a3;">âš¡ å…¨ä¸€æ‹¬ç™ºè¡Œ</button>
          <button class="btn-sub" id="btnGenerateMeetForDate" style="background:#dbeafe; color:#1e40af;">âš¡ è¡¨ç¤ºæ—¥ã®Meetç™ºè¡Œ</button>
          <button class="btn-sub" id="btnDeleteDayBatch">ğŸ—‘ï¸ è¡¨ç¤ºæ—¥ã®å…¨ãƒªãƒ³ã‚¯å‰Šé™¤</button>
      </div>
      <input type="text" id="searchInput" placeholder="åå‰ã§æ¤œç´¢..." style="margin-bottom:10px;">
      <div id="loading" style="font-size:12px; color:#666;">èª­ã¿è¾¼ã¿ä¸­...</div>
      <div class="table-wrapper">
        <table id="customerTable" style="display:none;">
          <thead>
            <tr><th>æ¥åº—æ—¥</th><th>æ™‚é–“</th><th>ãŠåå‰</th><th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th><th>é¢è«‡æ–¹å¼</th><th>æ‹…å½“</th><th>Meet</th><th>ã‚³ãƒ”ãƒ¼</th></tr>
          </thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="right-column">
    <div class="box" id="toolBox">
      <h1>ğŸ—“ é¢è«‡ãƒ¡ãƒ¢ & æ“ä½œ</h1>
      <div id="selectedNameDisplay" style="font-weight:bold; color:#2563eb; margin-bottom:10px;"></div>
      <label>æ—¥ä»˜</label><input type="date" id="date">
      <label>é–‹å§‹æ™‚é–“</label><select id="time"></select>
      <label>é¢è«‡æ–¹æ³•(ãƒ¡ãƒ¢ç”¨)</label>
      <select id="method"><option>Google Meet</option><option>é›»è©±</option><option>LINE</option><option>ãã®ä»–</option></select>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;">
        <button id="copyAllBtn">å…¨æ–‡ã‚³ãƒ”ãƒ¼</button><button class="secondary" id="copyDateBtn" style="background:#111827;">æ—¥æ™‚ã®ã¿ã‚³ãƒ”ãƒ¼</button>
      </div>
      <textarea id="preview" style="height:150px; font-family:monospace;"></textarea>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:20px; border-top:1px solid #eee; padding-top:15px;">
          <button style="background:#4f46e5;" id="btnCreateSingle">ğŸ”— å€‹åˆ¥ãƒªãƒ³ã‚¯ç™ºè¡Œ</button><button class="danger" id="btnDeleteSingle">ğŸ—‘ï¸ ãƒªãƒ³ã‚¯å‰Šé™¤</button>
      </div>
      <button class="cancel-status-btn" id="btnCancelStatus">ğŸš« ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†</button>
      <div class="edit-status-row">
        <div style="flex:1"><label style="margin-top:0">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´</label>
            <select id="editStatus"><option>äºˆç´„ç¢ºå®š</option><option>åˆå›é¢è«‡</option><option>ï¼‘ãƒµæœˆé¢è«‡</option><option>ï¼’ãƒµæœˆé¢è«‡</option><option>ï¼“ãƒµæœˆé¢è«‡</option><option>ï¼”ãƒµæœˆé¢è«‡</option><option>ï¼•ãƒµæœˆé¢è«‡</option><option>æº€æœŸé¢è«‡</option><option>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</option></select>
        </div><button id="btnUpdateStatus">ğŸ”„ æ›´æ–°</button>
      </div>
    </div>
    <div class="box" id="addBox">
      <h1>ğŸ“ æ–°è¦äºˆç´„ç™»éŒ² <span style="font-size:12px;color:#666;font-weight:normal">(ã‚¹ãƒ—ã‚·è¿½åŠ )</span></h1>
      <label>æ¥åº—æ—¥</label><input type="date" id="addDate">
      <label>æ™‚é–“</label><select id="addTime"></select>
      <label>ãŠåå‰</label><input type="text" id="addName" placeholder="å±±ç”° å¤ªéƒ">
      <label>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label><select id="addStatus"><option>äºˆç´„ç¢ºå®š</option><option>åˆå›é¢è«‡</option><option>æœˆæ¬¡é¢è«‡</option><option>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</option></select>
      <label>é¢è«‡æ–¹å¼</label><select id="addMethod"><option>Google Meet</option><option>é›»è©±</option><option>LINE</option><option>ãã®ä»–</option></select>
      <button style="background:#10b981;" id="btnAddManual">ï¼‹ äºˆç´„ã‚’è¿½åŠ ã™ã‚‹</button>
    </div>
  </div>
</div>
<script>
(() => {
  const API_URL = "https://script.google.com/macros/s/AKfycbz3AX4cK2ViWserTlSrlBg66hiNrAxwP4xZFeWb5tFPegzfGxikb7yAH0jNXVlrezRp/exec";
  let allData = []; let calDate = new Date(); let currentSelectedDateStr = ""; let selectedCustomerName = ""; 
  const dateEl = document.getElementById("date"), timeEl = document.getElementById("time"), methodEl = document.getElementById("method"), previewEl = document.getElementById("preview"), nameDisplay = document.getElementById("selectedNameDisplay"), editStatusEl = document.getElementById("editStatus");
  const addDateEl = document.getElementById("addDate"), addTimeEl = document.getElementById("addTime"), addNameEl = document.getElementById("addName"), addStatusEl = document.getElementById("addStatus"), addMethodEl = document.getElementById("addMethod");

  function init() { buildTimes(); setToday(); loadData(); setupEvents(); }
  function buildTimes() { timeEl.innerHTML = ""; addTimeEl.innerHTML = ""; for (let h = 5; h <= 23; h++) { const opt = document.createElement("option"); opt.value = String(h); opt.textContent = `${h}æ™‚ï½`; if(h === 10) opt.selected = true; timeEl.appendChild(opt); addTimeEl.appendChild(opt.cloneNode(true)); } }
  function setToday() { const t = new Date(); const s = `${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`; dateEl.value = s; addDateEl.value = s; }
  
  function setupEvents() {
    document.getElementById('prevMonthBtn').onclick = () => { calDate.setMonth(calDate.getMonth()-1); renderCalendar(); };
    document.getElementById('nextMonthBtn').onclick = () => { calDate.setMonth(calDate.getMonth()+1); renderCalendar(); };
    document.getElementById('btnTodayReset').onclick = () => { calDate = new Date(); const todayStr = `${calDate.getFullYear()}.${('0'+(calDate.getMonth()+1)).slice(-2)}.${('0'+calDate.getDate()).slice(-2)}`; currentSelectedDateStr = todayStr; renderCalendar(); filterListByDate(todayStr); };
    document.getElementById('btnShowAll').onclick = () => { currentSelectedDateStr = ""; selectedCustomerName = ""; nameDisplay.textContent = ""; renderCalendar(); renderList(sortDataByDateDesc(allData)); };
    document.getElementById('copyAllBtn').onclick = () => copyText(buildFullMessage());
    document.getElementById('copyDateBtn').onclick = () => copyText(buildDateBox());
    dateEl.onchange = renderPreview; timeEl.onchange = renderPreview; methodEl.onchange = renderPreview;
    document.getElementById('searchInput').onkeyup = (e) => { currentSelectedDateStr = ""; renderCalendar(); const val = e.target.value.toLowerCase(); renderList(sortDataByDateDesc(allData.filter(row => row.join(" ").toLowerCase().includes(val)))); };

    const actions = [
        {id:'btnGenerateMeet', act:'generateLinks', msg:'å…¨ä¸€æ‹¬ç™ºè¡Œã—ã¾ã™ã‹ï¼Ÿ'},
        {id:'btnGenerateMeetForDate', act:'generateLinksForDate', dateReq:true, msg:'è¡¨ç¤ºæ—¥ã®ãƒªãƒ³ã‚¯ã‚’ä¸€æ‹¬ç™ºè¡Œã—ã¾ã™ã‹ï¼Ÿ'},
        {id:'btnDeleteDayBatch', act:'deleteDayBatch', dateReq:true, msg:'è¡¨ç¤ºæ—¥ã®ãƒªãƒ³ã‚¯ã‚’å…¨å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ'},
        {id:'btnCreateSingle', act:'createSingle', nameReq:true, msg:'å€‹åˆ¥ç™ºè¡Œã—ã¾ã™ã‹ï¼Ÿ'},
        {id:'btnDeleteSingle', act:'deleteSingle', nameReq:true, msg:'ãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ'},
        {id:'btnCancelStatus', act:'cancelStatus', nameReq:true, msg:'ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†ã—ã¾ã™ã‹ï¼Ÿ'},
        {id:'btnUpdateStatus', act:'updateStatus', nameReq:true, msg:'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°ã—ã¾ã™ã‹ï¼Ÿ', extra:{newStatus:()=>editStatusEl.value}}
    ];
    actions.forEach(a => {
        document.getElementById(a.id).onclick = async () => {
            if(a.dateReq && !currentSelectedDateStr) return alert("æ—¥ä»˜ã‚’é¸ã‚“ã§ãã ã•ã„");
            if(a.nameReq && !selectedCustomerName) return alert("ãƒªã‚¹ãƒˆã‹ã‚‰äººã‚’é¸ã‚“ã§ãã ã•ã„");
            let params = {};
            if(a.dateReq) params.date = currentSelectedDateStr.replace(/\./g, '-'); else params.date = dateEl.value;
            if(a.nameReq) { params.time = timeEl.value; params.name = selectedCustomerName; }
            if(a.extra) { for(let k in a.extra) params[k] = a.extra[k](); }
            if(!confirm(a.msg)) return;
            await callApi(a.act, params, a.id, "å‡¦ç†ä¸­...");
        };
    });
    document.getElementById('btnAddManual').onclick = async () => {
        const d = addDateEl.value, n = addNameEl.value;
        if(!d || !n) return alert("æ—¥ä»˜ã¨åå‰ã¯å¿…é ˆã§ã™");
        if(!confirm(`äºˆç´„ã‚’è¿½åŠ ã—ã¾ã™ã‹ï¼Ÿ\n${d} ${n}æ§˜`)) return;
        await callApi("manualAdd", { date: d, time: addTimeEl.value + ":00", name: n, status: addStatusEl.value, method: addMethodEl.value }, "btnAddManual", "è¿½åŠ ä¸­...");
        addNameEl.value = "";
    };
  }

  window.updateListMethod = async (selectEl, date, time, name) => {
    selectEl.disabled = true; 
    try { await callApi("updateMethod", { date: date, time: time, name: name, newMethod: selectEl.value }, null, null, true); } 
    catch(e) { alert("å¤‰æ›´å¤±æ•—"); selectEl.disabled = false; }
  };

  async function callApi(action, params, btnId, loadingText, silent=false) {
    let btn = btnId ? document.getElementById(btnId) : null;
    let originalText = btn ? btn.textContent : "";
    if(btn) { btn.textContent = loadingText; btn.disabled = true; }
    try {
        const res = await fetch(API_URL, { method: 'POST', body: JSON.stringify({ action: action, ...params }) });
        const result = await res.json();
        if(!silent && action !== "manualAdd") alert(result.message);
        if(action === "manualAdd") alert("è¿½åŠ ã—ã¾ã—ãŸ");
        loadData();
    } catch(e) { alert("ã‚¨ãƒ©ãƒ¼: " + e.message); } finally { if(btn) { btn.textContent = originalText; btn.disabled = false; } }
  }

  function loadData() {
    document.getElementById('loading').style.display = 'block';
    fetch(API_URL).then(res => res.json()).then(data => {
        allData = data;
        if (currentSelectedDateStr) filterListByDate(currentSelectedDateStr);
        else renderList(sortDataByDateDesc(allData));
        renderCalendar();
        document.getElementById('loading').style.display = 'none';
        document.getElementById('customerTable').style.display = 'table';
    }).catch(err => { document.getElementById('loading').textContent = "èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼"; });
  }

  function renderList(data) {
    const tbody = document.getElementById('tableBody'); tbody.innerHTML = "";
    if(data.length === 0) { tbody.innerHTML = "<tr><td colspan='8' style='text-align:center; color:#999; padding:20px;'>ãƒ‡ãƒ¼ã‚¿ãªã—</td></tr>"; return; }
    const frag = document.createDocumentFragment();
    data.forEach(row => {
      const tr = document.createElement('tr'); tr.className = "clickable";
      const name = row[12]||row[6]||"ãªã—";
      const status = row[5] || ""; const methodVal = row[6] || "Google Meet";
      let statusHtml = status;
      if (status.includes("åˆå›")) statusHtml = `<span class="status-tag status-red">${status}</span>`;
      else if (status.includes("ãƒµæœˆ")) statusHtml = `<span class="status-tag status-blue">${status}</span>`;
      else if (status.includes("æº€æœŸ")) statusHtml = `<span class="status-tag status-orange">${status}</span>`;
      else if (status.includes("ã‚­ãƒ£ãƒ³ã‚»ãƒ«")) tr.classList.add("row-cancelled");
      
      const meetUrl = row[18] ? `<a href="${row[18]}" target="_blank" class="meet-link">ğŸ“¹å‚åŠ </a>` : "";
      const copyBtn = row[18] ? `<button class="copy-link-btn" onclick="event.stopPropagation(); copyToClipboard('${row[18]}')">ğŸ“‹</button>` : "";
      const accountBadge = row[19] ? `<span class="account-badge">${row[19]}</span>` : '<span style="font-size:10px;color:#ddd;">-</span>';
      const opts = ["Google Meet", "é›»è©±", "LINE", "ãã®ä»–"].map(o => `<option value="${o}" ${o===methodVal?"selected":""}>${o}</option>`).join("");
      const selectHtml = `<select class="method-select" onclick="event.stopPropagation()" onchange="updateListMethod(this, '${row[2]}', '${row[3]}', '${name}')">${opts}</select>`;

      tr.innerHTML = `<td>${row[2]}</td><td>${row[3]}</td><td style="font-weight:bold">${name}</td><td>${statusHtml}</td><td>${selectHtml}</td><td>${accountBadge}</td><td>${meetUrl}</td><td>${copyBtn}</td>`;
      tr.onclick = () => {
        document.querySelectorAll('tr').forEach(t => t.classList.remove('selected')); tr.classList.add('selected');
        if(row[2]) dateEl.value = safeDate(row[2]); if(row[3]) timeEl.value = String(parseInt(row[3]));
        selectedCustomerName = name; nameDisplay.textContent = `é¸æŠä¸­: ${name}`; editStatusEl.value = status || "äºˆç´„ç¢ºå®š";
        renderPreview(); if(window.innerWidth < 600) document.getElementById('toolBox').scrollIntoView({behavior:"smooth"});
      };
      frag.appendChild(tr);
    });
    tbody.appendChild(frag);
  }

  function renderCalendar() {
    const grid = document.getElementById('calendarGrid'); grid.innerHTML = "";
    ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"].forEach(w => { const d = document.createElement('div'); d.className = "cal-cell"; d.style.background="none"; d.style.cursor="default"; d.textContent = w; if(w==="æ—¥") d.style.color="red"; if(w==="åœŸ") d.style.color="blue"; grid.appendChild(d); });
    const y = calDate.getFullYear(), m = calDate.getMonth(); document.getElementById('calendarTitle').textContent = `${y}å¹´ ${m+1}æœˆ`;
    const first = new Date(y, m, 1), last = new Date(y, m+1, 0);
    for(let i=0; i<first.getDay(); i++) grid.appendChild(document.createElement('div'));
    for(let d=1; d<=last.getDate(); d++) {
        const div = document.createElement('div'); div.className = "cal-cell"; div.textContent = d;
        const targetStr = `${y}.${('0'+(m+1)).slice(-2)}.${('0'+d).slice(-2)}`;
        if(allData.some(r => r[2] && r[2].includes(targetStr))) div.classList.add("cal-has-event");
        if(targetStr === currentSelectedDateStr) div.classList.add("cal-selected");
        const check = new Date(y, m, d); if(check.getDay()===0) div.style.color="red"; else if(check.getDay()===6) div.style.color="blue";
        div.onclick = () => { currentSelectedDateStr = targetStr; renderCalendar(); filterListByDate(targetStr); };
        grid.appendChild(div);
    }
  }
  function filterListByDate(targetDateStr) { renderList(sortDataByTime(allData.filter(row => row[2] && row[2].includes(targetDateStr)))); }
  function sortDataByDateDesc(dataList) { return dataList.sort((a, b) => { if (a[2] !== b[2]) return a[2] < b[2] ? 1 : -1; return parseTime(a[3]) - parseTime(b[3]); }); }
  function sortDataByTime(dataList) { return dataList.sort((a,b)=>parseTime(a[3]) - parseTime(b[3])); }
  function parseTime(tStr) { if (!tStr) return 9999; const p = String(tStr).split(":"); return parseInt(p[0]) * 60 + (parseInt(p[1]) || 0); }
  function safeDate(s) { const m=s.match(/(\d{4})[\.\/\-](\d{1,2})[\.\/\-](\d{1,2})/); return m?`${m[1]}-${m[2]}-${m[3]}`:""; }
  function buildFullMessage() { return `é¢è«‡äºˆç´„æ—¥æ™‚\n${dateEl.value} ${timeEl.value}æ™‚ã€œ\næ‹…å½“ï¼šãƒ•ãƒ¤ã‚»ãƒ«ã‚µãƒãƒ¼ãƒˆ`; }
  function buildDateBox() { return `${dateEl.value} ${timeEl.value}æ™‚ã€œ`; }
  function renderPreview() { previewEl.value = buildFullMessage(); }
  async function copyText(t) { try{await navigator.clipboard.writeText(t);alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");}catch(e){alert("ã‚³ãƒ”ãƒ¼å¤±æ•—");} }
  init();
})();
</script>
</body>
</html>
