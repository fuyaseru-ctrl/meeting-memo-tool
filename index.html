<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ãƒ•ãƒ¤ã‚»ãƒ«é¡§å®¢ç®¡ç†</title>
<style>
  /* å…¨ä½“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: #f5f7fb;
    color: #333;
    padding: 20px;
    margin: 0;
  }

  /* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
  .container {
    max-width: 1000px;
    margin: 0 auto;
    background: #fff;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
  }

  h1 {
    text-align: center;
    font-size: 24px;
    margin-bottom: 20px;
    color: #2c3e50;
  }

  /* èª­ã¿è¾¼ã¿ä¸­ã®è¡¨ç¤º */
  #loading {
    text-align: center;
    font-weight: bold;
    color: #666;
    padding: 20px;
  }

  /* ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ */
  .table-wrapper {
    overflow-x: auto; /* ã‚¹ãƒãƒ›ã§æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    white-space: nowrap; /* ã‚¹ãƒãƒ›ã§æŠ˜ã‚Šè¿”ã•ãªã„ */
  }

  th, td {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
    text-align: left;
  }

  th {
    background-color: #f8f9fa;
    font-weight: 600;
    color: #555;
  }

  tr:hover {
    background-color: #f1f5f9;
  }

  /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®è‰²åˆ†ã‘ï¼ˆä¾‹ï¼‰ */
  .status-tag {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.85em;
    font-weight: bold;
    background: #eee;
    color: #555;
  }
  .status-äºˆç´„ç¢ºå®š { background: #e3f2fd; color: #1565c0; } /* é’ */
  .status-ã‚­ãƒ£ãƒ³ã‚»ãƒ« { background: #ffebee; color: #c62828; } /* èµ¤ */
  .status-æ¥åº—æ¸ˆã¿ { background: #e8f5e9; color: #2e7d32; } /* ç·‘ */

</style>
</head>
<body>

<div class="container">
  <h1>ğŸ“… ãƒ•ãƒ¤ã‚»ãƒ«äºˆç´„ãƒªã‚¹ãƒˆ</h1>
  
  <div id="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...<br>ï¼ˆåˆå›ã¯å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ï¼‰</div>

  <div class="table-wrapper">
    <table id="customerTable" style="display:none;">
      <thead>
        <tr>
          <th>æ¥åº—æ—¥</th>
          <th>æ™‚é–“</th>
          <th>ãŠåå‰</th>
          <th>æ‹…å½“ã‚¹ã‚¿ãƒƒãƒ•</th>
          <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
          <th>ã‚³ãƒ¼ã‚¹</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        </tbody>
    </table>
  </div>
</div>

<script>
  // â˜…ã‚ãªãŸãŒä½œã£ãŸWebã‚¢ãƒ—ãƒªã®URL
  const API_URL = "https://script.google.com/macros/s/AKfycbzUynvjJBAh2vCS_umO_I5_b4EsN5l6KnApahCpoY2EM9zGhrJAWrB2rUarBlSPzZoK/exec";

  fetch(API_URL)
    .then(response => response.json())
    .then(data => {
      const tbody = document.getElementById('tableBody');
      const loading = document.getElementById('loading');
      
      // ãƒ‡ãƒ¼ã‚¿ã‚’æ–°ã—ã„é †ã«ä¸¦ã³æ›¿ãˆï¼ˆå¿…è¦ãªã‚‰ï¼‰
      // data.reverse(); 

      data.forEach(row => {
        // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®åˆ—ç•ªå·ï¼ˆA=0, B=1, C=2...ï¼‰
        // äºˆç´„ãƒã‚¹ã‚¿ã®æ§‹é€ ã«åˆã‚ã›ã¦å–å¾—
        const date = row[2];      // Cåˆ—: äºˆç´„(æ¥åº—)æ—¥
        const time = row[3];      // Dåˆ—: äºˆç´„é–‹å§‹æ™‚é–“
        const status = row[5];    // Fåˆ—: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
        const staff = row[9];     // Jåˆ—: ã‚¹ã‚¿ãƒƒãƒ•
        
        // åå‰ã¯Måˆ—(æœ¬å)ã‚’å„ªå…ˆã€ãªã‘ã‚Œã°Gåˆ—(LINEå)ã‚’è¡¨ç¤º
        let name = row[12]; 
        if (!name || name === "") {
            name = row[6] + " (LINE)";
        }
        
        const course = row[8];    // Iåˆ—: ã‚³ãƒ¼ã‚¹

        // ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¡Œã‚’è¿½åŠ 
        const tr = document.createElement('tr');
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®è‰²ä»˜ã‘ç”¨ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆ
        const statusClass = "status-" + (status ? status.split(" ")[0] : "ãã®ä»–");

        tr.innerHTML = `
          <td>${date}</td>
          <td>${time}</td>
          <td style="font-weight:bold;">${name}</td>
          <td>${staff}</td>
          <td><span class="status-tag ${statusClass}">${status}</span></td>
          <td><small>${course}</small></td>
        `;
        tbody.appendChild(tr);
      });

      // èª­ã¿è¾¼ã¿å®Œäº†
      loading.style.display = 'none';
      document.getElementById('customerTable').style.display = 'table';
    })
    .catch(error => {
      console.error('Error:', error);
      document.getElementById('loading').innerHTML = "ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚<br>URLã‚„æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚";
    });
</script>

</body>
</html>
